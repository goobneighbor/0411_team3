<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.t09ether.home.dao.AdminDAO">
	<select id="totalRecord" resultType="int">
		select count(userid) totalRecord from registerinfo
		<if test="searchWord!=null">
			where ${searchKey} like '%${searchWord}%'
		</if> 
	</select>
	<select id="pageSelect" resultType="com.t09ether.home.dto.RegisterDTO">
	select * from
		(select * from 
			(
				select rownum, a.username, a.userid, a.tel, a.email, a.rank, a.writedate, a.report 
				from (select username, userid, tel, email, rank, writedate, report from registerinfo order by username) a
				<if test="searchWord!=null">
					and ${searchKey} like '%${searchWord}%'
				</if>
			)
		<![CDATA[ 
	  		where rownum<=${nowPage*onePageRecord} order by rownum asc
	  		]]>
	  		)
	  		
	  	<choose>
	  		<when test="nowPage!=totalPage">	
	  			<![CDATA[
	  			where rownum<=${onePageRecord} order by rownum asc
	  			]]>
	  		</when>
	  		<when test="nowPage==totalPage">
	  			<![CDATA[
	  			where rownum<=${lastPageRecord} order by rownum asc
	  			]]>	  		
	  		</when>
  		</choose>
	</select>
</mapper>