<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.t09ether.home.dao.OnlineJoinDAO">
	<select id="locationListSelect" resultType="com.t09ether.home.dto.OrderDTO">
 		select shareaddr, rest_count, on_no
 		from product_detail where pro_code=${param1}
 	</select>
 	<select id="getList" resultType="com.t09ether.home.dto.OrderDTO">
		select shareaddr, rest_count,on_no
		from product_detail where pro_code = ${pro_code}
		<if test="searchWrd != null">
			and
		    shareaddr like '%${searchWrd}%' 
		</if>
	</select>
	<select id="getSearchList" resultType="com.t09ether.home.dto.OrderDTO">
		select shareaddr, rest_count, on_no
		from product_detail where pro_code = ${pro_code}
		<if test="searchWrd != null">
		and shareaddr like '%${searchWrd}%' 
		</if>
	</select>
	<select id="proInfor" resultType="com.t09ether.home.dto.ProductDTO">
		SELECT p.pro_code, pro_name, pro_price, pro_total
 		from product p join order09 o
        on p.pro_code=o.pro_code and o.ord_no=${ord_no}
	</select>
	<select id="userRank" resultType="int">
		Select rank from registerinfo where userid=#{userid}	
	</select>
	<select id="ordNoSelect" resultType="int">
		Select ord_no from order09 where pro_code=${pro_code} and on_no=${on_no}	
	</select>
	<insert id="orderInsert">
	 	insert into order09(ord_no, pro_code, userid, ord_count, status, on_no) values(ord_no_sq.nextval, #{pro_code}, #{userid}, #{ord_count}, 1, #{on_no})
	</insert>
	<update id="restUpdate">
		update product_detail set rest_count = ${rest_count} where on_no=${on_no}
	</update>
</mapper>