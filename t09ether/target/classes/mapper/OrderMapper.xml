<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.t09ether.home.dao.OrderDAO">
	<insert id="onlineInsert">
	 	insert into product_detail(on_no, pro_code, userid, on_count, hit, shareaddr, sharedetail) values(on_no_sq.nextval, #{pro_code}, #{userid}, #{on_count}, 0, #{shareaddr}, #{sharedetail})
	</insert>
	
	<insert id="orderInsert">
	 	insert into order09(ord_no, pro_code, userid, ord_count, status) values(ord_no_sq.nextval, #{pro_code}, #{userid}, #{ord_count}, 1)
	</insert>
	
	<select id="orderSelect" resultType="com.t09ether.home.dto.OrderDTO">
		select o.userid,r.username, r.tel, r.email, r.zipcode, r.addr, r.addrdetail, r.rank, o.pro_code, o.pro_name, o.pro_price, o.image, o.pro_total, o.ord_no, o.userid, o.ord_count, o.status, o.shareaddr, o.sharedetail from registerinfo r join (select p.pro_code, p.pro_name, p.pro_price, p.image, p.pro_total, o.ord_no, o.userid, o.ord_count, o.status, o.shareaddr, o.sharedetail from order09 o join product p on o.pro_code=p.pro_code and o.pro_code=#{pro_code}) o on r.userid=o.userid 
	</select>
</mapper>